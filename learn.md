# 比赛收获
## 代码中函数的定义
### `class CashDataset(Dataset):`定义了一个CashDataset类，继承Dataset，可以利用PyTorch提供的一些功能和方法来处理数据集。比如：
#### `def __init__(self, data_dir, transform):`初始化函数，接受数据路径和进行数据变换操作。
#### `def __getitem__(self, index):`根据索引对数据进行处理。其中`img = img.transpose(2, 0, 1).astype('float')[:125]`是将图像的channel作为第一维度，只保留前125和通道（数据集.tif文件有125个通道）并且将数据类型转换为float类型。对于多通道的图片可以将想要的通道数通过[:125]进行裁剪。
#### `def __len__(self):`返回数据集的路径和标签。
#### `def get_img_info(data_dir):`通过图片路径作为输入，返回一个图片路径且带有标签Health，Other或Rust，且通过一个filter函数只处理.tif为后缀的图片。
### `def plot_loss(x, history):`画出损失函数的曲线图
### `def plot_acc(x, history):`画出训练的准确率曲线图
### `class Dr(nn.Module):`定义训练模型，在模型里面首先第一层里面的输入通道为125（与.tif文件的输入通道保持一致）输出为250通道，卷积核为3x3，步长为1，填充为1。
### `nn.Conv2d(125, 250, 3, 1, 1)：`输入通道数为125，输出通道数为250的卷积层，卷积核大小为3x3，步幅为1，填充为1。
### `nn.MaxPool2d(2,2,0)：`2x2最大池化层，步幅为2，填充为0。
### `nn.ReLU()：`ReLU激活函数。
### `nn.Conv2d(250, 100, 3, 1, 17)：`输入通道数为250，输出通道数为100的卷积层，卷积核大小为3x3，步幅为1，填充为17。
### `nn.MaxPool2d(2,2,0)：`2x2最大池化层，步幅为2，填充为0。
### `nn.Conv2d(100, 3, 3, 1, 17)：`输入通道数为100，输出通道数为3的卷积层，卷积核大小为3x3，步幅为1，填充为17。
### `nn.MaxPool2d(2,2,0)：`2x2最大池化层，步幅为2，填充为0。
### `resnet18()：`调用resnet18模型。
### `nn.Linear(1000, 3)：`输入维度为1000，输出维度为3的全连接层。
### `dr=Dr()``loss_fn=nn.CrossEntropyLoss()``learndata=0.0001`：调用Dr模型，设置nn.CrossEntropyLoss()（该损失函数结合了nn.LogSoftmax()和nn.NLLLoss()两个函数，在分类训练时常用）和学习率learndata，给出训练轮数就可以开始训练模型。
### 输出模块：将训练完成的模型保存成.pth文件，根据比赛要求调用模型将val文件夹下的.tif文件进行一个分类并且生成一个目录为IId和Category的.CSV文件。
## 损失函数的欠拟合与过拟合（模型只关注某一类特征）
### 训练集loss 不断下降，验证集loss不断下降：网络正常，仍在学习。
### 训练集loss 不断下降，验证集loss趋于不变，可能出现过拟合，数据分布不均匀。
### 训练集loss 不断下降，验证集loss不断上升，可能出现过拟合。训练集loss 趋于不变，验证集loss不断下降，数据集有问题。
### 训练集loss 趋于不变，验证集loss趋于不变，学习过程中遇到瓶颈，可以减小学习率或批量数目和更换梯度优化算法，也有可能网络设计问题。
### 训练集loss 不断上升，验证集loss不断上升，可能网络结构有问题，超参数设置不正确。
### 在调用模型训练时可以按照损失函数的大致趋势来判断自己的网络结构的问题所在。在调用Dr模型时训练集loss不断下降，测试集loss趋于不变，考虑到出现过拟合现象，修改Batch_Size的大小再次进行训练
## 总结：
### 在建立一个分类项目的时候的大致流程为：1）导入相关的数据包。2）数据集的创建，如果已经有相关的数据集就可以进行下一步。3）数据集的预处理。在这里要分清自己处理的数据类型，适当调整输入通道。4）打包数据集方便下一步操作（DataLoader）。5)创建训练模型，可以直接从数据包里面调用，也可以自己搭建。6）定义损失函数。7）开始训练模型：设置训练轮数、学习率、优化器等
##
